# ChatBot Console

### Установка зависимостей

```bash
npm install
```

### Запуск

```bash
npm run dev
```

### Запуск тестов

```bash
npm test
```

### Сборка для production

```bash
npm run build
npm start
```

#### Тесты

Реализовано **5 тестов** с использованием React Testing Library:

1. Создание нового диалога
2. Поиск диалога
3. Удаление диалога
4. Отправка сообщения и получение ответа ассистента
5. Ошибка ответа ассистента и повторная отправка (retry)

- Потоковая генерация ответа ассистента (ответ "нарастает" частями)
- Кнопка **Stop** для прерывания генерации (используется AbortController)
- Реализация через fetch streaming на API endpoint `/api/chat`

## Структура проекта

```
src/
├── app/                   # Next.js App Router
│   ├── api/chat/          # API endpoint для чата
│   ├── chat/[id]/         # Страница диалога
│   └── layout.tsx         # Корневой layout
├── components/            # React компоненты
│   ├── Chat.tsx          # Основной компонент чата
│   ├── Composer.tsx      # Компонент ввода сообщений
│   ├── MessageList.tsx   # Список сообщений с Markdown
│   ├── Sidebar.tsx       # Боковая панель с диалогами
│   └── ui/               # UI компоненты (shadcn/ui)
├── hooks/                # Custom хуки
│   ├── useChat.ts        # Логика работы с чатом
│   ├── useConversation.ts # Логика работы с одной conversation
│   └── useConversations.ts # Логика работы со списком conversations
├── shared/               # Общие утилиты и типы
│   ├── lib/
│   │   ├── formatText.ts # Форматирование Markdown
│   │   └── storage.ts    # Работа с LocalStorage
│   └── types/
│       └── chat.ts       # TypeScript типы
└── __tests__/            # Тесты
```

Бизнес-логика вынесена в custom хуки (`hooks/`) для:
- Переиспользуемости кода
- Упрощения тестирования
- Чистоты компонентов 

### Хранение данных

- Используется LocalStorage для сохранения conversations
- Состояние синхронизируется между компонентами через хуки
- Данные сохраняются автоматически при изменении

### Обработка ошибок

- Retry механизм для повторной отправки при ошибках
- Корректная обработка прерывания запроса (AbortController)

## Технологический стек

- **Framework**: Next.js 16 (App Router)
- **UI Library**: React 19
- **Language**: TypeScript
- **Styling**: Tailwind CSS
- **UI Components**: shadcn/ui
- **Markdown**: marked (с санитизацией) + Prism.js для code blocks
- **Testing**: Jest + React Testing Library
- **AI**: Mock endpoint (локальная имитация ответов)

## Что сделано дополнительно

- Адаптивный дизайн (мобильная версия)
- Подсветка синтаксиса для code blocks
- Копирование кода одной кнопкой
- ESLint для качества кода
- Защита от XSS через санитизацию HTML
- Accessibility улучшения (aria-labels, семантические элементы)

## Компромиссы и ограничения

### Mock API Endpoint
Приложение использует локальный mock endpoint вместо реального OpenAI API. Это позволяет:
- ✅ Тестировать приложение без необходимости настройки API ключа
- ✅ Работать локально без дополнительных затрат
- ✅ Проверять UI и функциональность независимо от внешних сервисов

**Ограничения:**
- Ответы ассистента являются предопределенными и не генерируются реальным AI
- Для использования реального OpenAI API необходимо заменить реализацию в `src/app/api/chat/route.ts`

### Лимит символов
- Максимальная длина сообщения: 1200 символов
- Визуальная индикация при приближении к лимиту
- Блокировка отправки при превышении лимита

